version: 0.0.1
module: test
dependencies:
  TF_VAR_project_id:
    from: infra-ground/init/create_accounts:output:$.projects.production.project_id
  TF_VAR_env_name:
    from: infra-ground/init/create_accounts:output:$.projects.production.env
  EXEIAC_TEST_admins_group:
    from: users/users_and_groups:output:$.groups.admin
  EXEIAC_TEST_ops_group:
    from: users/users_and_groups:output:$.groups.ops
  EXEIAC_TEST_bastion_dns:
    from: infra-ground/envs/production/bastion:output:$.bastion.internal_domain_name
    trigger_type: weak
  EXEIAC_TEST_bastion_instance_id: # used to know if we have to re-lay user
    from: infra-ground/envs/production/bastion:output:$.bastion.instance_id
inputs:
  - type: env_vars
    format: env
    path: ""
    datas:
      - TF_VAR_project_id
      - TF_VAR_env_name
      - EXEIAC_TEST_admins_group
      - EXEIAC_TEST_ops_group
      - EXEIAC_TEST_bastion_dns
      - EXEIAC_TEST_bastion_instance_id # used to know if we have to re-lay user
